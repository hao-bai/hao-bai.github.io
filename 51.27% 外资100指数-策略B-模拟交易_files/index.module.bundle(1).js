"use strict";!function a(n,i,s){function r(t,e){if(!i[t]){if(!n[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(d)return d(t,!0);throw(o=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",o}o=i[t]={exports:{}},n[t][0].call(o.exports,function(e){return r(n[t][1][e]||e)},o,o.exports,a,n,i,s)}return i[t].exports}for(var d="function"==typeof require&&require,e=0;e<s.length;e++)r(s[e]);return r}({1:[function(e,t,o){t.exports='<div class="backtotop__record"><div class="backtotop__record-head clear"><div class="backtotop__record-head__running backtotop__record-head__tab js-record-tab {{#runningShow}}active{{/runningShow}} " href="#running"> 进行中</div><div class="backtotop__record-head__done backtotop__record-head__tab js-record-tab {{#doneShow}}active{{/doneShow}}" href="#done">已完成</div><div class="backtotop__record-head__close"></div></div><div class="backtotop__record-body"><div id="running" class="backtotop__record-body__running {{#runningShow}}active{{/runningShow}} js-record"><ul> {{#running}}<li class="clear running__li"><div class="running__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}} huice">{{typeName}}</span><div class="backtotop__body-name-row"><p> <a href="{{href}}" class="backtotop__body-name">{{name}}</a> <span class="backtotop__body-run-used-time">{{usedSec}}</span></p></div><span class="backtotop__body-runningCircle"></span></div></div><div class="running__right backtotop__body-right {{statusClass}}" data-type={{typeId}} data-id={{id}}></div></li> {{/running}} {{^running}}<li class="no-data">没有发现项目～</li> {{/running}}</ul></div><div id="done" class="backtotop__record-body__done {{#doneShow}}active{{/doneShow}} js-record"><ul> {{#done}}<li class="clear"><div class="done__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}}">{{typeName}}</span><div class="backtotop__body-name-row"><p> <a href="{{href}}" class="backtotop__body-name">{{name}}</a> <span class="backtotop__body-run-used-time">{{usedSec}}</span></p></div></div></div><div class="done__right backtotop__body-right {{statusClass}}"></div></li> {{/done}} {{^done}}<li class="no-data">没有发现项目～</li> {{/done}}</ul></div></div><p class="backtotop__record-footer {{#isOver}}is-over{{/isOver}}"> 今日回测时长：{{duration.used}}/{{duration.free}}分钟 <a href="/view/vip/charge" target="_blank">延长免费回测时间</a></p></div>'},{}],2:[function(e,t,o){t.exports='<li class="qiyukf__entry backtotop-popover {{#qiyukfHidden}}hidden{{/qiyukfHidden}}"><div class="popover-content" style="width: 85px;margin-left: -95px;margin-top: 5px;">在线客服</div></li><li class="backtotop__progress {{#hidden}}hidden{{/hidden}}"><span class="backtotop__progress-count hidden"></span><div class="backtotop__record-container hidden"></div></li><li class="newUser backtotop__newUser hidden backtotop__scroll"><a href="/post/24debe6786302edc2febfc09b1312a6c" target="_blank"></a></li><li class="toTop backtotop__toTop hidden backtotop__scroll" id="top_btn"></li>'},{}],3:[function(O,e,t){e.exports=function(a,e){var t=O("@util/routeParam.component")().isMobile(),n=O("jquery");t||(a=a||window);function o(){document[k.hiddenProperty]?k.currentHtml=!1:(k.currentHtml=!0,C())}function i(){k.isLogin=window.loginStatus,I(),H(),y=b.render(y,k),_.find("#leftsead ul").prepend(y),C(),T(),q()}function s(o){a.location.href.indexOf(["/algorithm/backtest/summary","/default/research/detail"])<0&&n.ajax({url:"/community/post/userInfo",success:function(e){var t=(e=JSON.parse(e)).data;"00000"===e.code&&(Array.isArray(e.data)||(k.isLogin=!0,window.loginStatus=!0),o&&"function"==typeof o&&o(t))},error:function(){}})}function r(e){e=e||a.event,((e=n(e.target)).hasClass("backtotop__progress")||e.hasClass("backtotop__record-head__close"))&&(n(".backtotop__record-container").toggleClass("hidden"),k.stopInitRecord=!k.stopInitRecord,clearTimeout(k.initRecordTime),C())}function d(e){e=e||a.event,(e=n(e.target)).hasClass("backtotop__progress")||e.parents(".backtotop__progress").get(0)||n(".backtotop__record-container").hasClass("hidden")||(n(".backtotop__record-container").addClass("hidden"),k.stopInitRecord=!k.stopInitRecord,clearTimeout(k.initRecordTime),C())}function c(){var e=n(".js-record-tab"),t=n(".js-record"),o=n(this),a=n(o.attr("href"));e.removeClass("active"),t.removeClass("active"),o.addClass("active"),a.addClass("active"),"#done"===o.attr("href")?(k.doneShow=!0,k.runningShow=!1):(k.doneShow=!1,k.runningShow=!0)}function l(){var e=n(this),t=e.attr("data-type"),o=e.attr("data-id"),a={};if(a[t]=o,e.hasClass("disabled"))return!1;e.addClass("disabled"),h.promise(w[t],a,"POST").done(function(e){clearTimeout(k.initRecordTime),C()},function(e){m().createDialog({title:"提示",dialogCss:"backtotop__dialog",domHtml:e.msg,submitBtnText:"确定",cancelBtnCss:"hidden"})})}function u(){"off"!=scroll&&n("html, body").animate({scrollTop:0},300)}function p(){s(function(e){return a.ysf?void(e.uniqueKey?a.ysf("config",{uid:e.uniqueKey,name:e.alias||"",level:e.level||0,success:function(){n.get("/vip/index/setLabel"),a.ysf("open")},error:function(){a.ysf("open")}}):a.ysf("open")):BootstrapDialog.alert("打开客服对话框失败，请刷新页面后重试")})}function f(){var e,t;-1===window.location.href.indexOf("newwinapp")&&(e="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,t=e.replace(/hidden/i,"visibilitychange"),k.hiddenProperty=e,k.visibilityChangeEvent=t,s(i))}var _=n(e),h=O("@util/http.component")(),g=O("@util/render.component")(),m=O("@component/dialog/dialog.component"),b=O("mustache"),y=O("./index.component.html"),v=O("./asset/tpl/operation.record.html"),k={cdnPath:n(".js-cdn-path").val(),isLogin:!1,runningShow:!0,doneShow:!1,stopInitRecord:!1,currentHtml:!0,hideProgress:!1},w={statistics:"/algorithm/index/statistics",backtestId:"/algorithm/index/cancel",analyBacktestId:"/algorithm/backtest/analyCancel",factorAnalyId:"/algorithm/factorAnaly/cancel",url:{backtest:"/algorithm/backtest/detail?backtestId=",guiyin:"/algorithm/backtest/attributionAnaly?backtestId=",yinzi:"/algorithm/factorAnaly/detail?factorAnalyId="},getMessage:"/credits/index/getMessage"},C=function e(){if(k.isLogin&&!t){if(!k.currentHtml||k.hideProgress)return!1;h.promise(w.statistics).done(function(e){var t,o=e.data,e=o.duration;for(t in o.running.length?_.find(".backtotop__progress-count").removeClass("hidden").html(o.running.length):_.find(".backtotop__progress-count").addClass("hidden").html(""),o.runningShow=k.runningShow,o.doneShow=k.doneShow,o.isOver=e.used>e.free,o.running=o.running,o)o[t].length&&o[t].map(function(e,t){"0"===e.type?(e.typeId="backtestId",e.typeName="回测",e.typeClass="huice",e.href=w.url.backtest+e.id):"1"===e.type?(e.typeName="归因",e.typeClass="guiyin",e.typeId="analyBacktestId",e.href=w.url.guiyin+e.id):"2"===e.type&&(e.typeId="factorAnalyId",e.typeName="因子",e.typeClass="yinzi",e.href=w.url.yinzi+e.id),"2"===e.status?(e.statusClass="success",e.progressbarClass="progress-bar-success"):"3"===e.status||"4"===e.status?(e.statusClass="fail",e.progressbarClass="progress-bar-danger"):(e.progressbarClass="progress-bar-success",e.statusClass="cancel")});x(),g(_.find(".backtotop__record-container"),v,o),S()})}k.currentHtml&&(k.stopInitRecord?k.initRecordTime=setTimeout(e,3e3):k.initRecordTime=setTimeout(e,3e4))},x=function(){k.scrollT=n(".backtotop__record-body").scrollTop()},S=function(){n(".backtotop__record-body").scrollTop(k.scrollT)},T=function(){var e=n(a).scrollTop();t?n("#leftsead").addClass("hidden"):200<=e?n("#leftsead").find(".backtotop__scroll").removeClass("hidden"):n("#leftsead").find(".backtotop__scroll").addClass("hidden")},I=function(){["/algorithm/index/edit","/factor/factor/edit","/view/algorithm/fundraising","/algorithm/backtest/summary","/default/research/detail","/help/data/tableList","/help/data/dataTree"].forEach(function(e){-1!==a.location.href.indexOf(e)&&(k.qiyukfHidden=!0)})},H=function(){["/algorithm/backtest/summary","/default/research/detail","/algorithm/index/edit","/algorithm/factor/edit","algorithm/live/liveUrlShareIndex","/help/data/dataTree","/help/data/tableList"].map(function(e,t){0<=a.location.href.indexOf(e)&&(k.hideProgress=!0)}),["/algorithm/backtest/summary","/default/research/detail"].map(function(e,t){0<=a.location.href.indexOf(e)&&(k.iframeMessage=!0)}),k.isLogin&&!k.hideProgress||(k.hidden=!0),k.isLogin&&!k.iframeMessage||(k.iframeHidden=!0)},q=function(){k.isLogin&&h.promise(w.getMessage).done(function(e){var t,o;k.iframeHidden||(e.data&&(t=parseInt(e.data.credits.amount)<0?"cut-amount":"add-amount",o=parseInt(e.data.credits.amount)<0?e.data.credits.amount:"+"+e.data.credits.amount,n("#leftsead > ul").prepend('<li class="leftsead-message"> <div>'+e.data.credits.message+' 积分<span class="'+t+'">'+o+"</span></div> </li>")),setTimeout(function(){n("#leftsead").find(".leftsead-message").remove()},2e3))})};return{init:function(){f(),_.delegate(".backtotop__progress","click",r),_.delegate(".kk_body","click",d),_.delegate(".js-record-tab","click",c),_.delegate(".running__right.cancel","click",l),_.delegate("#top_btn","click",u),_.delegate(".qiyukf__entry","click",p),n(a).scroll(T),document.addEventListener(k.visibilityChangeEvent,o)}}}},{"./asset/tpl/operation.record.html":1,"./index.component.html":2,"@component/dialog/dialog.component":void 0,"@util/http.component":void 0,"@util/render.component":void 0,"@util/routeParam.component":void 0,jquery:"jquery",mustache:"mustache"}],4:[function(e,t,o){e("./index.component")(window,document.body).init()},{"./index.component":3}]},{},[4]);